from fastapi import Depends, HTTPException, status\nfrom fastapi.security import HTTPBearer, HTTPAuthorizationCredentials\nimport jwt\nfrom jwt.exceptions import InvalidTokenError\nfrom .config import settings\nfrom typing import Dict, Any\n\nsecurity = HTTPBearer()\n\nasync def get_current_user(token: HTTPAuthorizationCredentials = Depends(security)) -> Dict[Any, Any]:\n    credentials_exception = HTTPException(\n        status_code=status.HTTP_401_UNAUTHORIZED,\n        detail="Could not validate credentials",\n        headers={"WWW-Authenticate": "Bearer"},\n    )\n    \n    try:\n        payload = jwt.decode(token.credentials, settings.auth_secret, algorithms=[settings.jwt_algorithm])\n        user_id: str = payload.get("sub")\n        if user_id is None:\n            raise credentials_exception\n        return {"user_id": user_id}\n    except InvalidTokenError:\n        raise credentials_exception
